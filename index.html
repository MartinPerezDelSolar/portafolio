<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Portafolio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body { height: 100%; }

    body {
      background: #ffffff;
      overflow: hidden; /* toda la página fija, solo se mueve nuestro contenedor */
      font-family: system-ui, -apple-system, Helvetica, Arial, sans-serif;
      color: #111827;
    }

    /* CONTENEDOR PRINCIPAL: solo se mueve por JS */
    .snap-container {
      position: absolute;
      inset: 0;
      overflow-y: scroll;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      background: #ffffff;
    }

    .snap-container::-webkit-scrollbar { width: 0; height: 0; }

    .panel {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .panel-inner {
      width: 100%;
      height: 100%;
      border-radius: 0;
      overflow: hidden;
      background: #ffffff;
      box-shadow: 0 24px 60px rgba(0,0,0,0.06);
      transform-origin: center;
      transform: translateX(20px) scale(0.94);
      opacity: 0.6;
      filter: blur(2.5px);
      transition:
        transform 0.6s cubic-bezier(0.19, 0.66, 0.24, 1),
        opacity 0.6s ease-out,
        filter 0.6s ease-out;
    }

    .panel-inner.active {
      transform: translateX(0) scale(1);
      opacity: 1;
      filter: blur(0);
    }

    .image-wrapper {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
      overflow: hidden;
    }

    .portfolio-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain; /* SIEMPRE COMPLETAS, sin recortes */
    }

    /* ICONO DE TEXTO — cuadrado suave, derecha centrado */
    .info-toggle {
      position: fixed;
      right: 1rem;
      top: 50%;
      transform: translateY(-50%);
      width: 40px;
      height: 40px;
      border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.15);
      background: rgba(30,30,30,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 200;
      backdrop-filter: blur(12px);
      box-shadow: 0 0 14px rgba(0,0,0,0.3);
      opacity: 0.2;
      transition:
        opacity 0.3s ease-out,
        transform 0.25s ease-out;
    }

    .info-toggle.active {
      opacity: 1 !important;
    }

    .info-toggle:hover {
      transform: translateY(-50%) scale(1.06);
      opacity: 0.9;
    }

    .info-toggle-lines,
    .info-toggle-lines::before,
    .info-toggle-lines::after {
      content: "";
      display: block;
      width: 16px;
      height: 2px;
      background: rgba(255,255,255,0.92);
      border-radius: 4px;
      position: relative;
    }

    .info-toggle-lines::before {
      position: absolute;
      top: -5px;
    }

    .info-toggle-lines::after {
      position: absolute;
      top: 5px;
      width: 12px;
      opacity: 0.8;
    }

    /* PANEL DE TEXTO — hoja inferior con blur (móvil + desktop) */
    .info-panel {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      padding-bottom: env(safe-area-inset-bottom);
      height: 40vh;
      max-height: 320px;
      background: rgba(0,0,0,0.75);
      border-radius: 18px 18px 0 0;
      border-top: 1px solid rgba(255,255,255,0.18);
      backdrop-filter: blur(16px);
      padding: 0.9rem 1.2rem 1.2rem;
      box-shadow: 0 -18px 40px rgba(0,0,0,0.4);
      display: flex;
      flex-direction: column;
      transform: translateY(100%);
      opacity: 0;
      pointer-events: none;
      transition:
        transform 0.35s cubic-bezier(0.2, 0.7, 0.2, 1),
        opacity 0.35s ease-out;
      z-index: 190;
    }

    .info-panel.open {
      transform: translateY(0);
      opacity: 1;
      pointer-events: auto;
    }

    .info-panel.closing {
      transform: translateY(100%);
      opacity: 0;
      pointer-events: none;
    }

    .info-panel-content {
      font-size: 0.9rem;
      line-height: 1.6;
      white-space: pre-line;
      overflow-y: auto;
      color: rgba(249,250,251,0.96);
    }

    .info-panel-content::-webkit-scrollbar {
      width: 4px;
    }
    .info-panel-content::-webkit-scrollbar-thumb {
      background: rgba(148,163,184,0.55);
      border-radius: 999px;
    }

    @media (min-width: 768px) {
      .panel-inner {
        border-radius: 18px;
        max-width: 900px;
        margin: 0 auto;
      }
      .panel { padding: 0 1.4rem; }
      .info-panel {
        left: 50%;
        right: auto;
        width: min(420px, 70vw);
        transform: translate(50%, 100%);
      }
      .info-panel.open {
        transform: translate(50%, 0);
      }
      .info-panel.closing {
        transform: translate(50%, 100%);
      }
    }
  </style>
</head>
<body>
  <!-- ICONO TEXTO -->
  <div class="info-toggle" id="infoToggle" role="button">
    <span class="info-toggle-lines"></span>
  </div>

  <!-- PANEL TEXTO -->
  <aside class="info-panel" id="infoPanel">
    <div class="info-panel-content" id="infoContent"></div>
  </aside>

  <!-- GALERÍA -->
  <div class="snap-container" id="snapContainer">
    <main id="gallery"></main>
  </div>

  <script>
    const MAX_IMAGES = 40;
    const PATH = "imagenes";
    const PREFIX = "imagen";
    const EXT = ".jpg";

    // Textos de ejemplo (cámbialos por tus datos reales)
    const TEXTS = {
      1: "Descripción ejemplo imagen 1.\nTécnica, año, medidas, serie, etc.",
      2: "Descripción ejemplo imagen 2.",
      3: "Descripción ejemplo imagen 3.",
      // 4: "Descripción imagen 4", ...
    };

    function createPanels() {
      const gallery = document.getElementById("gallery");

      for (let i = 1; i <= MAX_IMAGES; i++) {
        const panel = document.createElement("section");
        panel.className = "panel";
        panel.dataset.index = i - 1; // index 0-based
        panel.style.display = "none";

        const inner = document.createElement("div");
        inner.className = "panel-inner";

        const wrap = document.createElement("div");
        wrap.className = "image-wrapper";

        const img = document.createElement("img");
        img.className = "portfolio-image";
        img.src = `${PATH}/${PREFIX}${i}${EXT}`;
        img.alt = "";

        img.onload = () => { panel.style.display = "flex"; };
        img.onerror = () => { panel.remove(); };

        wrap.appendChild(img);
        inner.appendChild(wrap);
        panel.appendChild(inner);
        gallery.appendChild(panel);
      }
    }

    function iconResetAnimation() {
      const icon = document.getElementById("infoToggle");
      icon.style.transition = "none";
      icon.style.opacity = "1";
      setTimeout(() => {
        icon.style.transition = "opacity 1.2s ease-out";
        icon.style.opacity = "0.2";
      }, 900);
    }

    function setupSlider() {
      const container = document.getElementById("snapContainer");
      const panels = Array.from(document.querySelectorAll(".panel"));
      const infoContent = document.getElementById("infoContent");
      const infoPanel = document.getElementById("infoPanel");
      const infoToggle = document.getElementById("infoToggle");

      if (panels.length === 0) return;

      let currentIndex = 0;
      let isAnimating = false;

      function updateActive() {
        panels.forEach((panel, i) => {
          const inner = panel.querySelector(".panel-inner");
          if (!inner) return;
          if (i === currentIndex) {
            inner.classList.add("active");
          } else {
            inner.classList.remove("active");
          }
        });

        // texto de la imagen activa (TEXTS usa índices 1,2,3,...)
        const text = TEXTS[currentIndex + 1] || "";
        infoContent.textContent = text;

        // cerrar panel de texto si estaba abierto
        if (infoPanel.classList.contains("open")) {
          infoPanel.classList.remove("open");
          infoPanel.classList.add("closing");
          infoToggle.classList.remove("active");
          setTimeout(() => {
            infoPanel.classList.remove("closing");
          }, 300);
        }

        // animación del icono
        iconResetAnimation();
      }

      function goToIndex(newIndex) {
        newIndex = Math.max(0, Math.min(panels.length - 1, newIndex));
        if (newIndex === currentIndex) return;
        if (isAnimating) return;

        isAnimating = true;
        currentIndex = newIndex;

        const targetPanel = panels[currentIndex];
        const targetTop = targetPanel.offsetTop;

        updateActive();

        container.scrollTo({
          top: targetTop,
          behavior: "smooth"
        });

        setTimeout(() => {
          isAnimating = false;
        }, 650);
      }

      // Ir a la primera imagen al inicio
      updateActive();
      container.scrollTo({ top: panels[0].offsetTop, behavior: "instant" || "auto" });

      // Navegación con rueda del mouse (PC / laptop)
      container.addEventListener("wheel", (e) => {
        e.preventDefault();
        if (isAnimating) return;
        if (e.deltaY > 10) {
          goToIndex(currentIndex + 1);
        } else if (e.deltaY < -10) {
          goToIndex(currentIndex - 1);
        }
      }, { passive: false });

      // Navegación por swipe (móvil / tablet)
      let touchStartY = null;
      let touchEndY = null;

      container.addEventListener("touchstart", (e) => {
        if (e.touches.length === 1) {
          touchStartY = e.touches[0].clientY;
          touchEndY = touchStartY;
        }
      }, { passive: true });

      container.addEventListener("touchmove", (e) => {
        if (touchStartY == null) return;
        touchEndY = e.touches[0].clientY;
      }, { passive: true });

      container.addEventListener("touchend", (e) => {
        if (touchStartY == null || touchEndY == null) return;
        const deltaY = touchStartY - touchEndY;
        const threshold = 40; // mínimo para considerar swipe

        if (Math.abs(deltaY) > threshold) {
          if (deltaY > 0) {
            // swipe hacia arriba → siguiente imagen
            goToIndex(currentIndex + 1);
          } else {
            // swipe hacia abajo → imagen anterior
            goToIndex(currentIndex - 1);
          }
        } else {
          // si el movimiento fue pequeño, simplemente volver a centrar la actual
          const targetTop = panels[currentIndex].offsetTop;
          container.scrollTo({ top: targetTop, behavior: "smooth" });
        }

        touchStartY = null;
        touchEndY = null;
      });
    }

    function setupInfoToggle() {
      const icon = document.getElementById("infoToggle");
      const panel = document.getElementById("infoPanel");

      const toggle = () => {
        const isOpen = panel.classList.toggle("open");
        panel.classList.remove("closing");
        icon.classList.toggle("active", isOpen);
      };

      icon.addEventListener("click", toggle);
      icon.addEventListener("touchend", (e) => {
        e.preventDefault();
        toggle();
      }, { passive: false });
    }

    document.addEventListener("DOMContentLoaded", () => {
      createPanels();
      // pequeño delay para que carguen los nodos en el DOM
      setTimeout(() => {
        setupSlider();
        setupInfoToggle();
        iconResetAnimation();
      }, 300);
    });
  </script>
</body>
</html>
